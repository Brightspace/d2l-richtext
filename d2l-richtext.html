<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../s-html/s-html.html">

<!--
	@demo demo/d2l-richtext.html
-->
<dom-module id="d2l-richtext">
	<template>
		<s-html html="[[_processedRichtext]]"></s-html>
	</template>

	<script>
		'use strict';
		Polymer({
			is: 'd2l-richtext',
			properties: {
				richtext: {
					observer: '_onRichTextChanged',
					type: String
				},
				_processedRichtext: String,
				quicklinkConsumer: {
					type: String,
					default: null
				}
			},
			ready: function() {
				this._onRichTextChanged(this.richtext);
			},
			_onRichTextChanged: function(richtext) {
				if (!richtext) {
					return;
				}
				var curVal = richtext;
				curVal = this._replaceIfProviderGiven(/(<\/? ?)d2l-richtext-quicklink/g, this.quicklinkConsumer, richtext);
				this._processedRichtext = curVal;
			},
			_replaceIfProviderGiven: function(tagName, provider, richtext) {
				if (!provider) {
					return richtext;
				}
				function replace (str, tagStart) {
					return tagStart + provider;
				}
				return richtext.replace(tagName, replace);
			}
		});
	</script>
</dom-module>
